<tr id="subdomain-row-{{ item.id }}" class="theme-table__row theme-table__row--editing">
  <td colspan="6" class="theme-table__cell">
    <form
      class="theme-form"
      hx-put="/api/subdomains/{{ item.id }}"
      hx-target="#subdomain-feedback"
      hx-swap="innerHTML"
      data-success-event="refresh-subdomains"
    >
      <div class="theme-form__grid theme-form__grid--three">
        <div class="theme-field">
          <label for="host-{{ item.id }}" class="theme-label">子域</label>
          {% set domain_suffix = '' %}
          {% set suffix = '' %}
          {% if base_domain %}
          {% set suffix = '.' ~ base_domain %}
          {% if item.host.endswith(suffix) %}
          {% set domain_suffix = base_domain %}
          {% endif %}
          {% endif %}
          {% set host_ns = namespace(value=item.host) %}
          {% if domain_suffix %}
          {% set host_ns.value = item.host[: item.host|length - ('.' ~ domain_suffix)|length] %}
          {% endif %}
          <div
            class="theme-input-affix"
            data-domain-input
            data-domain-suffix="{{ domain_suffix }}"
          >
            <input
              id="host-{{ item.id }}"
              type="text"
              required
              value="{{ host_ns.value }}"
              class="theme-input-affix__input"
              autocomplete="off"
              spellcheck="false"
              data-domain-input-field
            />
            <span class="theme-input-affix__addon theme-input-affix__addon--suffix">.{{ base_domain }}</span>
            <input type="hidden" name="host" value="{{ item.host }}" data-domain-input-hidden />
          </div>
        </div>
        <div class="theme-field">
          <label for="code-{{ item.id }}" class="theme-label">状态码</label>
          <select id="code-{{ item.id }}" name="code" class="theme-select" required>
            {% for option in subdomain_code_options %}
            <option value="{{ option }}" {% if option == item.code %}selected{% endif %}>{{ option }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="theme-field theme-form__span-full">
          <label for="target-{{ item.id }}" class="theme-label">目标地址</label>
          <input
            id="target-{{ item.id }}"
            name="target_url"
            type="url"
            required
            value="{{ item.target_url }}"
            class="theme-input"
          />
        </div>
      </div>
      <div class="theme-form__footer">
        <p class="theme-helper">更新后会覆盖现有跳转配置并刷新列表。</p>
        <div class="theme-form__actions">
          <button
            type="button"
            class="theme-button theme-button--ghost theme-button--sm"
            hx-get="/admin/subdomains/{{ item.id }}/row"
            hx-target="closest tr"
            hx-swap="outerHTML"
          >
            取消
          </button>
          <button type="submit" class="theme-button theme-button--solid theme-button--sm">
            保存
          </button>
        </div>
      </div>
    </form>
  </td>
</tr>
